function Invoke-VulnerabilityScanner {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [string]$ProjectPath,
        [Parameter(Mandatory = $true)]
        [ValidateSet('npm', 'dotnet')]
        [string]$ProjectType,
        [Parameter(Mandatory = $false)]
        [ValidateSet('Critical', 'High', 'Moderate', 'Low', 'All')]
        [string]$MinimumSeverity = 'All'
    )

    $vulnerabilities = switch ($ProjectType) {
        'npm' {
            Get-NpmVulnerabilities -ProjectPath $ProjectPath -MinimumSeverity $MinimumSeverity
        }
        'dotnet' {
            Get-DotnetVulnerabilities -ProjectPath $ProjectPath -MinimumSeverity $MinimumSeverity
        }
    }

    return $vulnerabilities
}

Export-ModuleMember -Function Invoke-VulnerabilityScanner