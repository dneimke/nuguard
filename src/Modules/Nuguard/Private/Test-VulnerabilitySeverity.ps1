function Test-VulnerabilitySeverity {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [ValidateSet('CRITICAL', 'HIGH', 'MODERATE', 'LOW', 'UNKNOWN', $null)]
        [string]$Severity,

        [Parameter(Mandatory = $true)]
        [ValidateSet('Critical', 'High', 'Moderate', 'Low', 'All')]
        [string]$MinimumSeverity
    )

    # Define severity levels and their corresponding weights
    $severityWeights = @{
        'CRITICAL' = 4
        'HIGH' = 3
        'MODERATE' = 2
        'LOW' = 1
        'UNKNOWN' = 0
    }

    $minWeights = @{
        'Critical' = 4
        'High' = 3
        'Moderate' = 2
        'Low' = 1
        'All' = 0
    }

    # Handle null or unknown severity
    if ([string]::IsNullOrEmpty($Severity)) {
        $severityWeight = 0
    }
    else {
        $severityWeight = $severityWeights[$Severity.ToUpper()]
    }

    $minimumWeight = $minWeights[$MinimumSeverity]

    return $severityWeight -ge $minimumWeight
}

Export-ModuleMember -Function Test-VulnerabilitySeverity
